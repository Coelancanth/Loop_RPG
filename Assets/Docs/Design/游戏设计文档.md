
# **游戏设计文档**

## **1. 项目概述**
### 1.1 游戏简介
这是一款融合了“Loop Hero”、“城市建设”、“经济系统”、“RPG 系统”以及 Roguelite 元素的独特2D游戏。玩家在循环路径上进行战斗，同时建设城市和管理资源。游戏的核心目标是通过战略性资源利用、路径规划和角色构建击败最终 Boss，并在完成主线后进入在线竞技场，与其他玩家的角色构建进行对决。

### 1.2 游戏特点
1. **路径编辑与循环系统**：
   - 玩家可以根据资源情况自定义路径，优化循环效率。
2. **城建与经济系统**：
   - 建设建筑提升资源生成与战斗能力。
3. **RPG 系统**：
   - 角色升级、装备系统、技能树开发。
4. **战斗系统**：
   - 支持自动战斗与手动策略元素。
5. **Roguelite 随机性**：
   - 随机敌人、事件与装备掉落，增加游戏重玩性。
6. **竞技场模式**：
   - 完成主线后与其他玩家的构建进行在线对战。

---

## **2. 核心机制**

### 2.1 循环路径系统
#### 设计目标：
玩家利用资源建设循环路径，提升效率，推动循环进度。

#### 关键功能：
1. **路径编辑**：
   - 玩家可以拖放、删除或修改路径 Tile。
2. **计数器与事件触发**：
   - 每次路径改动增加计数器，当计数达到一定阈值时触发一定事件。
   - 同时加入步数计数器，当步数达到一定阈值时触发一定事件。
3. **资源影响**：
   - 不同路径类型需要不同资源；路径设计影响资源掉落。

#### 数据结构与实现：
- **Tile**：
  - 属性：类型、状态（建造中、已建造）、资源消耗。
  - 功能：连接性检查、路径优化算法。
- **计数器**：
  - 属性：当前值、触发阈值。
  - 功能：监听路径事件，触发 Boss 战或随机事件。

### 2.1.2 初始化路径
#### 设计目标
- 提供一个初始化路径，作为游戏开始时的默认路径。
   - 此路径根据不同的初始化种子生成。
   - 此路径是一个循环路径
- 路径的初始化的因素也与职业有关，不同的职业有不同的初始化路径。

---

### 2.2 城建与经济系统
#### 设计目标：
- 提供城市建设功能，通过建筑提升资源生成与战斗力。
- 资源的获取与消耗

#### 关键功能：
1. **资源管理**：
   - 玩家收集木材、矿石、金币等资源。
2. **建筑功能**：
   - 不同建筑提供不同效果，例如：
     - 农田：增加食物资源。
     - 兵营：提升角色攻击力。
3. **动态平衡**：
   - 随着循环进展，资源生成与消耗动态调整。

#### 数据结构与实现：
- **资源管理器**：
  - 属性：资源类型、数量、最大存储。
  - 功能：资源增减、溢出检测。
- **建筑管理器**：
  - 属性：建筑类型、升级状态。
  - 功能：生产资源、提升角色属性。

---

### 2.3 战斗与 RPG 系统
#### 设计目标：
融合自动化与策略性战斗，让玩家体验成长与构建的乐趣。自走棋的战斗系统。两边都是9x9的格子配置。按照攻击策略自动进行战斗。

#### 关键功能：
1. **角色成长**：
   - 玩家通过经验值提升等级，解锁技能。
2. **装备与技能系统**：
   - 随机掉落装备，提供被动或主动技能。
3. **敌人与 Boss**：
   - 每次循环生成随机敌人，Boss 拥有独特机制。

#### 数据结构与实现：
- **角色属性**：
  - 属性：生命值、攻击力、防御力、技能冷却。
- **技能树**：
  - 属性：技能名称、效果、解锁条件。
- **战斗管理器**：
  - 功能：回合管理、敌人生成、战斗逻辑。

---

### 2.4 Roguelite 随机性
#### 设计目标：
通过随机性增加游戏重玩性与策略深度。

#### 关键功能：
1. **随机地图生成**：
   - 每次循环地图的路径初始状态不同。
2. **随机事件**：
   - 事件类型：资源奖励、精英战、陷阱。
3. **装备与掉落**：
   - 装备稀有度、属性随机生成。

---

### 2.5 竞技场模式
#### 设计目标：
提供玩家上传角色数据，与其他玩家的角色构建对战的功能。

#### 关键功能：
1. **角色上传与存储**：
   - 玩家通过服务器上传角色属性与装备信息。
2. **匹配系统**：
   - 根据角色属性进行公平匹配。
3. **战斗模拟**：
   - 根据双方属性计算对战结果。

#### 数据结构与实现：
- **角色数据格式**：
  - 属性：等级、装备、技能树状态。
- **服务器接口**：
  - 功能：上传与拉取角色数据。
- **模拟战斗逻辑**：
  - 使用服务器计算战斗结果，减少客户端作弊风险。

---
### 2.6 Tile系统
功能性 Tile

    - 资源类 Tile
        - 矿山 (Mine)：每轮产出矿石资源。
        - 农田 (Farm)：每轮产出食物资源，支持城建系统。
        - 贸易站 (TradePost)：允许交换资源或提供加成。

    - 战斗类 Tile
        怪物巢穴 (MonsterNest)：生成敌人，战胜后可获得稀有资源或装备。
        精英战斗 (EliteTile)：提供高难度战斗挑战，掉落高级装备。
        - Boss 召唤点 (BossTile)：可提前触发 Boss 战。

    - 辅助类 Tile
        - 休息点 (Campfire)：角色停留后恢复部分生命值。
        - 祭坛 (Altar)：触发随机增益/减益效果（如攻击力提升或资源消耗增加）。
        - 传送点 (TeleportTile)：提供路径捷径或角色传送。
    
    - 道路类 Tile
        - 道路 (Road)：连接不同 Tile，提供移动路径。
        - 不同的道路有不同的步数消耗。

    - 特殊效果 Tile
        - 环境类 Tile
            - 森林 (Forest)：提供隐蔽效果，使敌人攻击几率降低。
            - 山脉 (Mountain)：增加玩家防御力，但移动速度下降。
            - 沼泽 (Swamp)：限制角色恢复能力（如无法回血）。

    - 动态 Tile
        - 腐化路径 (CorruptedTile)：持续腐化相邻的 Tile，变为更危险的地块。
        - 时间枢纽 (TimeTile)：改变游戏速度（加速/减速角色与敌人行动）。
        - 熔岩路径 (LavaTile)：增加通过该路径时的生命值消耗。

2. Tile 升级与建造系统

允许玩家对 Tile 进行升级或建造，增加资源管理与路径规划的深度。

    - 升级系统
        - 道路升级：基础路径（TileType.Road）可升级为更高效的路径（如快捷道或防御路径）。
        - 资源 Tile 升级：提高产出效率，例如农田从「低级农田」升级为「高产农田」。

    - 建造系统
        - 玩家可在空 Tile 上建造指定地块（如防御塔、资源点等），需要消耗资源。
        - 例子：
            - 箭塔 (DefenseTower)：自动攻击路径上的敌人。
            - 仓库 (StorageTile)：扩展资源存储上限。

3. Tile 互动与连锁机制

增加 Tile 之间的互动效果，鼓励玩家进行有策略的布局。

    连锁效果
        相邻 Tile 会触发特殊效果，例如：
            三座山脉组合：触发「高山」效果，提供额外防御或资源加成。
            森林 + 祭坛：提高祭坛的增益效果。

    连线奖励
        玩家连续建造某种 Tile（如道路）时，触发增益效果：
            连续 5 个道路 Tile 提供移动加速。
            连续 3 个资源类 Tile 提高资源产出。

    区域控制
        玩家建造一定数量的 Tile 后，该区域可以被「占领」，提供全局增益或特殊效果。

4. 动态变化的 Tile

增加随机性与挑战性，使 Tile 具备动态变化的特点。

    腐化机制
        某些 Tile 随着游戏进度逐渐腐化，变成更危险的地块，迫使玩家改变路径。
        例子：道路变为「腐化路径」，角色受到持续伤害。

    季节变化
        Tile 的效果随季节改变，例如：
            冬季：森林变为「雪地」，降低移动速度。
            夏季：农田产量增加。

    随机事件
        某些 Tile 上触发随机事件，提供奖励或挑战，例如：
            地震导致山脉崩塌。
            雨水灌溉使农田产出翻倍。

5. 可视化与反馈

加强 Tile 在游戏中的视觉效果，提升玩家体验。

    动态视觉效果
        资源类 Tile 显示产出动画（如矿山闪烁、农田作物生长）。
        战斗类 Tile 显示敌人图标或战斗特效。

    状态提示
        不同状态的 Tile（已腐化、升级中、战斗中）显示不同颜色或图标。





## **3. 技术栈与工具**

### 3.1 引擎与编程语言
- **引擎**：Unity3D。
- **语言**：C#。

### 3.2 网络与存储
- **服务器**：
  - 技术：Node.js、MongoDB 或 Python + PostgreSQL。
  - 功能：存储玩家数据、处理对战匹配。
- **联网方式**：
  - REST API：用于角色数据传输。
  - WebSocket：用于实时竞技场对战。

### 3.3 其他工具
- **版本控制**：Git + GitHub。
- **任务管理**：Trello 或 Jira。

---

## **4. 开发阶段计划**

### 阶段 1: 核心系统开发
- 实现路径编辑、计数器、资源管理。

### 阶段 2: 战斗与 RPG 系统开发
- 开发战斗逻辑、角色属性与技能树。

### 阶段 3: 城建与经济系统开发
- 实现建筑效果与资源生产逻辑。

### 阶段 4: Boss 战与随机事件
- 实现 Boss 战机制与随机事件触发。

### 阶段 5: 竞技场与联网功能
- 开发角色上传、匹配与战斗模拟。

### 阶段 6: 优化与扩展
- 添加新路径类型、敌人机制与地图生成逻辑。

---

## **5. 游戏视觉与音效**
- **视觉风格**：像素风或低多边形风格。
- **音效与音乐**：动态背景音乐，增强 Roguelite 氛围。

---

## **6. 风险与解决方案**
1. **复杂度过高**：
   - 使用模块化开发降低耦合度。
2. **资源平衡问题**：
   - 定期调整数值，进行玩家测试。
3. **联网安全性**：
   - 使用服务器验证机制，避免数据篡改。

---

**总结**：这是一个全面的设计文档。如果需要进一步细化或具体到代码级别的设计，请告诉我！
